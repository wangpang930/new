<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”¦é²¤æ¬§çš‡é£Ÿå ‚ </title>
    <style>
        /* CSS éƒ¨åˆ†å·²ä¿®æ”¹ */
        @import url("https://fontsapi.zeoseven.com/568/main/result.css");
        body, html {
            margin: 0; padding: 0; width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Microsoft YaHei", sans-serif;
            display: flex; justify-content: center; align-items: flex-start;
            padding: 5vh 20px; box-sizing: border-box; min-height: 100vh;
        }
        .fixed-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: linear-gradient(160deg, #bde0fe 0%, #ffc8dd 100%);
        }
        .member-bubbles {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        .member-bubble {
            position: absolute; border-radius: 50%;
            background-size: contain; background-repeat: no-repeat; background-position: center;
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            opacity: 0; transition: opacity 0.5s ease, transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            animation: wobble 6s ease-in-out infinite;
            pointer-events: auto;
        }
        
        .member-bubble.selected-bubble {
            transform: scale(1.15);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.9), 0 0 10px rgba(255, 105, 180, 0.8);
            border-color: rgba(255, 105, 180, 0.8);
        }
        @keyframes mismatch-shake {
            0%, 100% { transform: translateX(0) scale(1.1); }
            25% { transform: translateX(-6px) scale(1.1); }
            75% { transform: translateX(6px) scale(1.1); }
        }
        .member-bubble.mismatch {
            animation: mismatch-shake 0.3s ease-in-out;
        }

        @keyframes wobble {
            0%   { transform: translate(0, 0) rotate(-1deg); }
            50%  { transform: translate(0, 0) rotate(1deg); }
            100% { transform: translate(0, 0) rotate(-1deg); }
        }
        @keyframes pop-out { to { transform: scale(0); opacity: 0; } }
        .member-bubble.popping-out { animation: pop-out 0.3s ease-out forwards; }
        
        .container {
            background-color: rgba(255, 255, 255, 0.35); border-radius: 20px;
            padding: 30px 40px;
            box-shadow: 0 8px 32px 0 rgba(79, 85, 126, 0.2);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            text-align: center; max-width: 450px; width: 100%;
            animation: fadeIn 0.8s ease-out;
            position: relative; z-index: 1; pointer-events: auto;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('https://i.postimg.cc/6QWWDKnX/OIP.webp'); 
            background-repeat: repeat; 
            opacity: 0.15;
            animation: flow-texture 25s linear infinite; 
        }
        @keyframes flow-texture {
            from { background-position: 0 0; }
            to { background-position: -512px 512px; }
        }
        
        .container > * { position: relative; z-index: 2; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .logo { width: 100px; height: 100px; margin: 0 auto 15px auto; border-radius: 50%; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 20px rgba(168, 85, 247, 0.6); }
        .logo:hover { transform: scale(1.1) rotate(5deg); box-shadow: 0 0 35px rgba(168, 85, 247, 0.9); }
        h1 { font-size: 2.5rem; margin: 0 0 20px 0; font-family: "Fusion Pixel 10px M zh_hans", sans-serif; font-weight: normal; background: linear-gradient(45deg, #f089d7, #5784f1); -webkit-background-clip: text; background-clip: text; color: transparent; text-shadow: 3px 3px 0px rgba(88, 28, 135, 0.3); }
        
        @keyframes ticketFloat { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-10px); } 
            100% { transform: translateY(0px); } 
        }
        .ticket { 
            max-width: 100%; height: auto; margin: 25px 0; 
            cursor: pointer; 
            transition: transform 0.3s ease-in-out; 
            animation: ticketFloat 4s ease-in-out infinite; 
        }
        .ticket:hover { 
            animation-play-state: paused; 
            transform: scale(1.08);
        }
        
        .info { margin-top: 20px; color: #4b5563; line-height: 1.8; font-size: 1rem; }
        .info p { margin: 10px 0; }
        .highlight { position: relative; overflow: hidden; font-weight: 600; color: #ffffff; padding: 5px 12px; border-radius: 6px; display: inline-block; margin: 4px 2px; border: none; background: linear-gradient(120deg, #ffc8dd, #bde0fe, #c7b0e8, #ffc8dd); background-size: 300% 300%; animation: aurora-glow 8s ease infinite; text-shadow: 0 1px 2px rgba(0,0,0,0.2); transition: transform 0.2s ease; vertical-align: middle; }
        .highlight:hover { transform: scale(1.05) translateY(-2px); }
        .highlight::before { content: ''; position: absolute; top: 0; left: 0; width: 40%; height: 100%; background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.5), transparent); animation: shimmer 5s infinite; animation-delay: 2s; }
        .platform { padding: 15px; border-radius: 10px; margin-top: 30px; font-size: 1.1rem; border: 1px solid rgba(255, 255, 255, 0.2); background: rgba(255, 255, 255, 0.15); display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 8px; }
        .platform-title { font-family: "Fusion Pixel 10px M zh_hans", sans-serif; font-weight: normal; background: linear-gradient(90deg, #f794c4, #89cff0); -webkit-background-clip: text; background-clip: text; color: transparent; text-shadow: 2px 2px 0px rgba(88, 28, 135, 0.2); }
        .platform-item { color: #ffffff; padding: 5px 12px; border-radius: 6px; display: inline-block; transition: transform 0.2s ease, box-shadow 0.2s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1); font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .platform-item:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .platform-item-1 { background-color: #a0e9ff; }
        .platform-item-2 { background-color: #dcb4f5; }
        .platform-item-3 { background-color: #ffafcc; }
        .easter-egg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.4); backdrop-filter: blur(5px); z-index: 1000; display: none; justify-content: center; align-items: center; animation: fadeIn 0.3s ease; padding: 20px; box-sizing: border-box; }
        .easter-egg-card { background-color: #fff; border-radius: 16px; padding: 25px 30px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.2); max-width: 350px; width: 100%; position: relative; transform: scale(0.95); opacity: 0; animation: popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        @keyframes popIn { to { transform: scale(1); opacity: 1; } }
        .easter-egg-card img { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 15px; border: 3px solid #ffafcc; object-fit: cover; }
        .easter-egg-card h3 { margin: 0 0 10px; font-size: 1.5rem; color: #333; }
        .easter-egg-card p { margin: 0 0 20px; font-size: 1rem; color: #666; line-height: 1.6; }
        .easter-egg-close-btn { background-color: #ffafcc; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: background-color 0.2s ease, transform 0.2s ease; min-width: 120px; }
        .easter-egg-close-btn:hover { background-color: #ff8fab; transform: scale(1.05); }

        .score-board {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: #4b5563;
            padding: 8px 20px;
            border-radius: 15px;
            font-family: "Fusion Pixel 10px M zh_hans", sans-serif;
            font-size: 1.1rem;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        }
        /* ã€å·²ä¿®æ”¹ã€‘ç§¯åˆ†æ ·å¼ */
        #score {
            font-weight: bold;
            color: #ff90aa; /* é¢œè‰²å·²æ›´æ”¹ä¸ºäº®æ©™è‰² */
            text-shadow: 0 0 8px rgba(249, 115, 22, 0.6); /* é˜´å½±é¢œè‰²åŒæ­¥æ›´æ”¹ */
            font-size: 1.3rem;
        }
    </style>
</head>
<body>
    <div class="fixed-background"></div>
    <div class="container">
        <img src="https://i.postimg.cc/zvXZTRVb/9-4-1.gif" alt="é”¦é²¤æ¬§çš‡Logo" class="logo">
        <h1>æ¬§çš‡é”¦é²¤<br>é£Ÿå ‚</h1>
        <img src="https://i.postimg.cc/J7JBFDYV/image.png" alt="é‚€è¯·ç¥¨æ ¹" class="ticket">
        <div class="info">
            <p> é‚€è¯·æœ‹å‹æ¥ç©ï¼Œè¯·æŒ‡è·¯<br> <span class="highlight">å°çº¢ä¹¦</span> æœç´¢ <span class="highlight">ã€Œä¸€æ¡å°é”¦é²¤ã€</span><br> ä¸»é¡µè¿›å…¥å®¡æ ¸ç¾¤ </p>
        </div>
        <div class="platform">
            <span class="platform-title">å…¨å¹³å°airpç¤¾åŒºï¼š</span>
            <span class="platform-item platform-item-1">é…’é¦†</span>
            <span class="platform-item platform-item-2">tavo</span>
            <span class="platform-item platform-item-3">omate</span>
        </div>
    </div>
    <div class="member-bubbles"></div>
    <div id="easterEggOverlay" class="easter-egg-overlay">
        <div class="easter-egg-card">
            <img id="easterEggImage" src="" alt="å½©è›‹å¤´åƒ">
            <h3 id="easterEggTitle"></h3>
            <p id="easterEggContent"></p>
            <button id="closeEasterEggBtn" class="easter-egg-close-btn"></button>
        </div>
    </div>

    <div class="score-board">
        <span>ç§¯åˆ†:</span>
        <span id="score">0</span>
    </div>

    <!-- SCRIPT éƒ¨åˆ†æ— éœ€ä¿®æ”¹ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const bubbleContainer = document.querySelector('.member-bubbles');
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const card = document.querySelector('.container');
            const cardRect = card.getBoundingClientRect();
            
            // æ¸¸æˆçŠ¶æ€
            let firstSelection = null;

            // é…ç½®é¡¹
            const safeZonePaddingHorizontal = 0.15, safeZonePaddingTop = -1.0, safeZonePaddingBottom = -1.0;
            const safeZoneRect = {
                left:   cardRect.left + cardRect.width * safeZonePaddingHorizontal,
                right:  cardRect.right - cardRect.width * safeZonePaddingHorizontal,
                top:    cardRect.top + cardRect.height * safeZonePaddingTop,
                bottom: cardRect.bottom - cardRect.height * safeZonePaddingBottom
            };
            const placedBubbles = [], maxAttempts = 200;

            let minSize, maxSize;
            if (screenWidth < 768) { // æ‰‹æœºæˆ–å°å±å¹•
                minSize = 25;
                maxSize = 35;
            } else { // ç”µè„‘å¤§å±å¹•
                minSize = 40;
                maxSize = 55;
            }

            const bubbleDensity = 2500; 
            const initialBubbleCount = Math.floor((screenWidth * screenHeight) / bubbleDensity);

            const STORAGE_KEY = 'jinli_diner_clicks';
            const INDIVIDUAL_THRESHOLD = 5;
            const GLOBAL_THRESHOLD = 50;

            const memberIcons = [
                'https://i.postimg.cc/j55dq3Pm/1.png', 'https://i.postimg.cc/FKGH4Xd0/2.png', 'https://i.postimg.cc/BvJnkn6q/3.png', 'https://i.postimg.cc/qR5BNcGR/kiki.png', 'https://i.postimg.cc/t70X5XwG/image.png', 'https://i.postimg.cc/VsJnDDpK/image.png', 'https://i.postimg.cc/cLBnrjtL/image.png', 'https://i.postimg.cc/sfbS85Rs/image.png', 'https://i.postimg.cc/9fXqTpyt/image.png', 'https://i.postimg.cc/Qx55rVX5/image.png', 'https://i.postimg.cc/XqBjdZ2g/image.png', 'https://i.postimg.cc/vZsn8MBK/image.png', 'https://i.postimg.cc/fWVf2gsk/nerd.png', 'https://i.postimg.cc/t70T2gjd/cloud-1.png', 'https://i.postimg.cc/Y9Ycgc7V/IMG-1404.png'
            ];
            
            const individualEasterEggs = {
                'https://i.postimg.cc/j55dq3Pm/1.png': { owner: 'ç²‰èƒèŸ¹', title: 'è¿™é‡Œæ€ä¹ˆæœ‰æ•èŸ¹ç¬¼ï¼', content: 'ä¸€å®šè¦ç‹ ç‹ é­ç­–è¿™ä¸ªç²‰èƒèŸ¹è€å¸ˆæ¬å¡åšç¾åŒ–å•Šå¥½å—å¥½çš„ã€‚', button: 'èŸ¹å¤©èŸ¹åœ°ä½ æ¥å•¦' }, 
                'https://i.postimg.cc/FKGH4Xd0/2.png': { owner: 'Marscoco', title: 'è¢«æˆ³å°±è¿™æ ·æ‰æ‰åœ°èµ°å¼€', content: 'åä¸‹ä½œå“åŒ…æ‹¬ä½†ä¸é™äºMarsé¢„è®¾/å°å‰§åœº/é€šç”¨ç¾åŒ–/è’‹ä½œé—»<br>è¯¶ï¼Ÿéš¾é“å¥¹çœŸçš„æ˜¯å¤©æ‰', button: 'æˆ‘çœŸçš„ä¸æ˜¯mï¼' }, 
                'https://i.postimg.cc/BvJnkn6q/3.png': { owner: 'æ²ˆå¼¥', title: '[é”™è¯¯429] è¯·æ±‚è¿‡äºé¢‘ç¹', content: 'èƒŒå¾·å¥³ç¥Geå¼¥ni-2.5-pro-preview-06-05-maxthinkingå†³å®šæˆªæ–­ä½ æ­£åœ¨ç­‰å¾…çš„å›å¤', button: 'æˆ‘æ˜¯å¼¥å¦¹' }, 
                'https://i.postimg.cc/qR5BNcGR/kiki.png': { owner: 'Kiki', title: 'ç»™æˆ‘ä¹°KFCåƒ', content: 'å¤§ç«çƒ­ç‚’é™ˆè§‰æ–é­”ä¸¸ç”·é«˜å¯¹æŠ—è·¯10+å¼€åœºç™½çƒ­ç©æ˜Ÿéœ²è°·ç‰©è¯­<br>è¯·å¤šå¤šå…³å¿ƒå§ï¼ï¼', button: 'å·¦æ‰‹ä¸€åªki' }, 
                'https://i.postimg.cc/t70X5XwG/image.png': { owner: 'å’ª', title: 'æˆ‘ä¸€ç›´åœ¨çœ‹ç€ä½ ', content: 'è·¯è¿‡è¯·æ‘¸æ‘¸å’ªçš„è€³æœµ<br>ç„¶åå’ªè¦ç»§ç»­æ‹‰ç£¨', button: 'åŠ©åŠ›å’ªæˆä¸ºé¦–å¸­é»‘å¥´' }, 
                'https://i.postimg.cc/VsJnDDpK/image.png': { owner: 'æ±Ÿæ±Ÿ', title: 'æˆ‘å†ä¹Ÿä¸æ•¢ææŠ½è±¡äº†!', content: 'Destinyçš„åˆ›ä½œè€…<br>é•œçš„ç¼”é€ è€…<br>æ—¶å…‰ç…§ç›¸é¦†ä¸»ç†äºº<br>æ«çš„æ¸¸ä¹åœºè€æ¿<br>â€”â€”è¿™é‡Œä½ä¸ä¸‹è¿™ä¹ˆå¤šäººï¼', button: 'èº«ä¸Šè¿˜èƒŒç€ä¸€ä¸ªå°æ±Ÿæ±Ÿå‘€' }, 
                'https://i.postimg.cc/cLBnrjtL/image.png': { owner: 'æ±¤åœ†', title: 'åœ†ç¥ï¼Œå¯åŠ¨ï¼', content: 'æ‰‹é€Ÿä¸å®¡ç¾é½é£çš„è‚å¸ï¼Œèƒ½è®©ç¬”ä¸‹æ¯ä¸ªå´½éƒ½å®ç°æµ·æŠ¥è‡ªç”±ã€‚<br>æ®ä¸å®Œå…¨ç»Ÿè®¡ï¼Œåœ†å­è¢«æˆè€çš„é¢‘ç‡ä¸å¥¹äº§å‡ºçš„ç¾è²Œæµ·æŠ¥æ•°é‡æˆæ­£æ¯”ã€‚', button: 'å¸®å°åœ†å¢åŠ å®¡æ ¸è½¬åŒ–ç‡' }, 
                'https://i.postimg.cc/sfbS85Rs/image.png': { owner: 'ç±³çº¿', title: 'ä¸€ç¢—çƒ­ä¹ä¹çš„ç±³çº¿', content: 'è€å¸ˆæ°åˆ°å¥½å¤„çš„æ¸©æŸ”ä¸æ”¯æŒï¼Œæ˜¯è¿™é‡Œæœ€å®è´µã€æœ€ä»¤äººå®‰å¿ƒçš„æ—¥å¸¸ã€‚', button: 'å›å®¶åƒé¥­å•¦' }, 
                'https://i.postimg.cc/9fXqTpyt/image.png': { owner: 'å°é¢‚', title: 'é¢‚ç‹¸å‡ºæ²¡ä¸­', content: 'å°±è¿™ä¸ªç‹—ç”·æ¶çŠ¬å´‡é‡çˆ½ï¼<br>å°±è¿™ä¸ªçœŸéª¨å“¥å“¥æ²ˆæ˜é“®çˆ½ï¼<br>å°±è¿™ä¸ªæ¸¯é£å¹´ä¸Šå‚…æ³½ç”Ÿçˆ½ï¼', button: 'å¤§å¤«æˆ‘è¦çœ‹éª¨ç§‘' }, 
                'https://i.postimg.cc/Qx55rVX5/image.png': { owner: 'Vivi', title: 'å‰ç¥¥ç‰©', content: 'ä½ ä½¿ç”¨å¤§å¸ˆçƒæ•è·å°é”¦é²¤ä¸€æ¡<br>æ¥å¸å¸æ¬§æ°”', button: 'æ”¶ä¸‹å¥½è¿' }, 
                'https://i.postimg.cc/XqBjdZ2g/image.png': { owner: 'é¸¡è…¿å­', title: 'istjå¬·å¬·å—å®³è€…', content: 'åœŸè±¡istjå°±è¿™æ ·å¸¦ç€ç­å‘³æ°´ç¾¤<br>è…¿å„¿ä½ åˆ«å¤ªç´¯äº†ä¹Ÿåˆ«æ­‡ç€', button: 'å¬·å¬·è…¿å„¿' }, 
                'https://i.postimg.cc/vZsn8MBK/image.png': { owner: 'ä¹Œé¸¦', title: 'äººï¼Œé¸¦å¾ˆæ‹…å¿ƒä½ ', content: 'ä¸€ä¸ªäººåœ¨å¤–é¢ç”Ÿæ´»å¤ªè¾›è‹¦äº†ï¼<br>æ‰€ä»¥é¸¦é¸¦ç»™ä½ å¸¦äº†å°èœ˜è››â€”â€”ğŸ•·ï¸å‘½è¿è››ç½‘', button: 'å³æ‰‹ä¸€åªé¸¦' },
                'https://i.postimg.cc/fWVf2gsk/nerd.png': { owner: 'åºŸæŸ´', title: 'æœ‰ç”¨çš„çŸ¥è¯†åˆå¢åŠ äº†ï¼', content: 'ä»Šå¤©åˆä»ç¾¤é‡Œå­¦åˆ°ä¸å°‘ï¼Œå…ˆè®°ä¸‹æ¥â€¦<br>å‰ä¸¤å¤©ç ”ç©¶äº†ä¸€ä¸‹æ³¨å†Œå°ä½œæ–‡ï¼Œæ€»ç»“å‡ºäº†ä¸€å¥—ä¸‡èƒ½æ¨¡æ¿ã€‚', button: 'ç­‰æˆ‘ç¿»ç¿»ç¬”è®°' },
                'https://i.postimg.cc/t70T2gjd/cloud-1.png': { owner: 'ç©ºç©º', title: 'æˆ‘ä¸‹æµ·äº†è¯·å¤šå¤šæ”¯æŒ', content: 'ç»ˆäºå†³å®šè‡ªå·±ç«¯èµ·é”…é“²äº†ã€‚<br>åªæ˜¯å¹³å¹³æ— å¥‡å¤§é¦‹ä¸«å¤´ä¸€æš', button: 'ç«‹å³æŸ¥é˜…æ–°ä½œ' },
                'https://i.postimg.cc/Y9Ycgc7V/IMG-1404.png': { owner: 'å¾‹å¸ˆ', title: 'å¥¹ç§ä¸‹å°±æ˜¯è–¯æ¡å†°æ·‡æ·‹éƒ½æ¥å•Š', content: 'é£Ÿå ‚æœ€çŒ›æ”¶ç‹—äºº<br>æœ‰ç‹—ä½ å°±æŠ¥<br>æ˜¯ç‹—æˆ‘å°±è¦<br>ç”µè¯ä¸€å“æˆ‘å°±åˆ°', button: 'æ”¶ç‹—æ”¶å¤§ç‹—' }
            };
            const globalEasterEgg = {
                image: 'https://i.postimg.cc/zvXZTRVb/9-4-1.gif', title: 'æ³¡æ³¡ç»ˆç»“è€…ï¼', content: 'ä½ å¤ªå‰å®³äº†ï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼<br>æˆ–è€…å»è·Ÿæœ‹å‹ä»¬èŠèŠå¤©ï¼Ÿ', button: 'æˆ‘è¿˜èƒ½ç©ï¼'
            };
            
            // DOM å…ƒç´ 
            const easterEggOverlay = document.getElementById('easterEggOverlay');
            const easterEggImage = document.getElementById('easterEggImage');
            const easterEggTitle = document.getElementById('easterEggTitle');
            const easterEggContent = document.getElementById('easterEggContent');
            const closeEasterEggBtn = document.getElementById('closeEasterEggBtn');
            const scoreDisplay = document.getElementById('score');

            // --- å‡½æ•°åŒº ---
            
            function createBubble() { 
                let currentBubbleInfo = {}, hasOverlap = true, attempts = 0; 
                while (hasOverlap && attempts < maxAttempts) { 
                    const size = Math.random() * (maxSize - minSize) + minSize; 
                    const radius = size / 2; 
                    const x = Math.random() * (screenWidth - size), y = Math.random() * (screenHeight - size); 
                    if (x + size > safeZoneRect.left && x < safeZoneRect.right && y + size > safeZoneRect.top && y < safeZoneRect.bottom) { 
                        attempts++; continue; 
                    } 
                    currentBubbleInfo = { id: Date.now() + Math.random(), x, y, radius }; 
                    hasOverlap = false; 
                    for (const placed of placedBubbles) { 
                        const dx = currentBubbleInfo.x - placed.x, dy = currentBubbleInfo.y - placed.y; 
                        const distance = Math.sqrt(dx * dx + dy * dy); 
                        if (distance < currentBubbleInfo.radius + placed.radius + 5) { 
                            hasOverlap = true; break; 
                        } 
                    } 
                    attempts++; 
                } 
                if (!hasOverlap) { 
                    placedBubbles.push(currentBubbleInfo); 
                    const bubble = document.createElement('div'); 
                    bubble.className = 'member-bubble'; 
                    bubble.dataset.id = currentBubbleInfo.id; 
                    const size = currentBubbleInfo.radius * 2; 
                    bubble.style.width = `${size}px`; 
                    bubble.style.height = `${size}px`; 
                    bubble.style.left = `${currentBubbleInfo.x}px`; 
                    bubble.style.top = `${currentBubbleInfo.y}px`; 
                    bubble.style.backgroundImage = `url(${memberIcons[Math.floor(Math.random() * memberIcons.length)]})`; 
                    bubble.style.animationDuration = `${Math.random() * 4 + 6}s`; 
                    bubble.style.animationDelay = `-${Math.random() * 5}s`; 
                    bubbleContainer.appendChild(bubble); 
                    setTimeout(() => { bubble.style.opacity = '0.9'; }, 50); 
                } 
            }

            function getClickData() { 
                const data = localStorage.getItem(STORAGE_KEY); 
                try {
                    const parsed = data ? JSON.parse(data) : { global: 0, individuals: {}, score: 0 };
                    if (parsed.score === undefined) parsed.score = 0; // å‘åå…¼å®¹
                    return parsed;
                } catch (e) {
                    return { global: 0, individuals: {}, score: 0 };
                } 
            }

            function saveClickData(data) { 
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); 
            }

            function showEasterEgg(data) { 
                easterEggImage.src = data.image; 
                easterEggTitle.innerHTML = data.title; 
                easterEggContent.innerHTML = data.content; 
                closeEasterEggBtn.innerHTML = data.button; 
                easterEggOverlay.style.display = 'flex'; 
            }

            function popBubble(bubble) {
                const bubbleId = parseFloat(bubble.dataset.id);
                const indexToRemove = placedBubbles.findIndex(b => b.id === bubbleId);
                if (indexToRemove > -1) {
                    placedBubbles.splice(indexToRemove, 1);
                }
                bubble.classList.add('popping-out');
                setTimeout(() => {
                    bubble.remove();
                    createBubble();
                }, 300);
            }
            
            function animateScoreUpdate() {
                const scoreBoard = document.querySelector('.score-board');
                if (scoreBoard) {
                    scoreBoard.style.transform = 'translateX(-50%) scale(1.15)';
                    setTimeout(() => {
                        scoreBoard.style.transform = 'translateX(-50%) scale(1)';
                    }, 250);
                }
            }

            // --- äº‹ä»¶ç›‘å¬ä¸ä¸»é€»è¾‘ ---

            bubbleContainer.addEventListener('click', function(event) {
                const clickedBubble = event.target.closest('.member-bubble');
                if (!clickedBubble || clickedBubble.classList.contains('popping-out')) return;

                if (!firstSelection) {
                    firstSelection = clickedBubble;
                    firstSelection.classList.add('selected-bubble');
                } else {
                    const secondSelection = clickedBubble;
                    
                    if (firstSelection === secondSelection) {
                        firstSelection.classList.remove('selected-bubble');
                        firstSelection = null;
                        return;
                    }

                    const firstUrl = firstSelection.style.backgroundImage;
                    const secondUrl = secondSelection.style.backgroundImage;

                    if (firstUrl === secondUrl) {
                        firstSelection.classList.remove('selected-bubble');
                        
                        popBubble(firstSelection);
                        popBubble(secondSelection);

                        const clickData = getClickData();
                        let scoreToAdd = 5; // æˆåŠŸåŒ¹é…åŸºç¡€åˆ†
                        let triggeredEasterEgg = false;

                        const rawUrl = firstUrl.slice(5, -2);
                        clickData.individuals[rawUrl] = (clickData.individuals[rawUrl] || 0) + 1;
                        console.log(`åŒ¹é…æˆåŠŸ! æ€»åŒ¹é…: ${clickData.global + 1}, ${individualEasterEggs[rawUrl]?.owner || 'æœªçŸ¥'} åŒ¹é…: ${clickData.individuals[rawUrl]}`);

                        if (clickData.individuals[rawUrl] >= INDIVIDUAL_THRESHOLD) {
                            const eggInfo = individualEasterEggs[rawUrl];
                            if (eggInfo) {
                                triggeredEasterEgg = true;
                                scoreToAdd += 25; // ç‹¬ç«‹å½©è›‹å¥–åŠ±ç§¯åˆ†
                                const displayData = { image: rawUrl, title: eggInfo.title, content: eggInfo.content, button: eggInfo.button.trim() };
                                showEasterEgg(displayData);
                                clickData.individuals[rawUrl] = 0; // é‡ç½®è®¡æ•°
                            }
                        }

                        clickData.global++;
                        if (!triggeredEasterEgg && clickData.global >= GLOBAL_THRESHOLD) {
                            scoreToAdd += 50; // å…¨å±€å½©è›‹å¥–åŠ±ç§¯åˆ†
                            showEasterEgg(globalEasterEgg);
                            clickData.global = 0; // é‡ç½®è®¡æ•°
                        }

                        clickData.score += scoreToAdd;
                        saveClickData(clickData);
                        
                        scoreDisplay.textContent = clickData.score;
                        animateScoreUpdate();

                    } else {
                        firstSelection.classList.remove('selected-bubble');
                        
                        firstSelection.classList.add('mismatch');
                        secondSelection.classList.add('mismatch');
                        setTimeout(() => {
                            if(firstSelection) firstSelection.classList.remove('mismatch');
                            if(secondSelection) secondSelection.classList.remove('mismatch');
                        }, 300);
                    }
                    
                    firstSelection = null;
                }
            });

            closeEasterEggBtn.addEventListener('click', () => { easterEggOverlay.style.display = 'none'; });
            easterEggOverlay.addEventListener('click', (event) => { if (event.target === easterEggOverlay) { easterEggOverlay.style.display = 'none'; } });

            // åˆå§‹åŒ–
            scoreDisplay.textContent = getClickData().score;
            for (let i = 0; i < initialBubbleCount; i++) { createBubble(); }
        });
    </script>
</body>
</html>
